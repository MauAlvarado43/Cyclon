"use strict";function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}Object.defineProperty(exports,"__esModule",{value:true});exports.validateToken=exports.generateToken=exports.encryptFront=exports.encryptFromFront=exports.encryptAndroid=exports.encryptAES=exports.decryptFront=exports.decryptAndroid=exports.decryptAES=void 0;var _crypto=_interopRequireDefault(require("crypto"));var CryptoJS=_interopRequireWildcard(require("crypto-js"));var _logger=require("./logger");var _jsonwebtoken=_interopRequireDefault(require("jsonwebtoken"));function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap;var cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{"default":obj}}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj["default"]=obj;if(cache){cache.set(obj,newObj)}return newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var algorithm="aes-256-cbc";var passwordAES="TStrzyg!zGXNvKyK3xkQW#6arP{q6AcL";var IV="5183666c72eec9e4";var _key="Y01JNiM0cFRhXmFBN0gwaVFsazlmJG8kckw0Xmk2d2Q=";var _iv="AcynMwikMkW4c7+mHtwtfw==";var encryptAndroid=function encryptAndroid(plainText){var key=CryptoJS.enc.Base64.parse(_key);var iv=CryptoJS.enc.Base64.parse(_iv);return CryptoJS.AES.encrypt(plainText.trim(),key,{iv:iv}).toString()};exports.encryptAndroid=encryptAndroid;var decryptAndroid=function decryptAndroid(cryptedText){var key=CryptoJS.enc.Base64.parse(_key);var iv=CryptoJS.enc.Base64.parse(_iv);return CryptoJS.AES.decrypt(cryptedText,key,{iv:iv}).toString(CryptoJS.enc.Utf8)};exports.decryptAndroid=decryptAndroid;var encryptFromFront=function encryptFromFront(plainText){try{global.navigator={appName:"nodejs"};global.window={};var JSEncrypt=require("./JSEncrypt")["default"];var cipher=new JSEncrypt;cipher.setPublicKey(publicKeyuser);return cipher.encrypt(plainText)}catch(err){if(err)_logger.errorLog.error(err);return null}};exports.encryptFromFront=encryptFromFront;var encryptFront=function encryptFront(plainText){try{global.navigator={appName:"nodejs"};global.window={};var JSEncrypt=require("./JSEncrypt")["default"];var cipher=new JSEncrypt;cipher.setPublicKey(publicKeyServer);return cipher.encrypt(plainText)}catch(err){if(err)_logger.errorLog.error(err);return null}};exports.encryptFront=encryptFront;var decryptFront=function decryptFront(cryptedText){try{global.navigator={appName:"nodejs"};global.window={};var JSEncrypt=require("./JSEncrypt")["default"];var cipher=new JSEncrypt;cipher.setPrivateKey(privateKeyServer);return cipher.decrypt(cryptedText).toString("utf8")}catch(err){if(err)_logger.errorLog.error(err);return null}};exports.decryptFront=decryptFront;var encryptAES=function encryptAES(plainText){try{var cipher=_crypto["default"].createCipheriv(algorithm,passwordAES,IV);var encrypted=cipher.update(plainText,"utf8","base64");encrypted+=cipher["final"]("base64");return encrypted}catch(err){if(err)_logger.errorLog.error(err);return null}};exports.encryptAES=encryptAES;var decryptAES=function decryptAES(cryptedText){try{var decipher=_crypto["default"].createDecipheriv(algorithm,passwordAES,IV);var decrypted=decipher.update(cryptedText,"base64","utf8");return decrypted+decipher["final"]("utf8")}catch(err){if(err)_logger.errorLog.error(err);return null}};exports.decryptAES=decryptAES;var generateToken=function generateToken(duration){return _jsonwebtoken["default"].sign({foo:_crypto["default"].randomBytes,iat:Math.floor(Date.now()/1e3)+duration},"=L;aSx&MuAYeb.8x")};exports.generateToken=generateToken;var validateToken=function validateToken(token){return _jsonwebtoken["default"].decode(token,"=L;aSx&MuAYeb.8x",function(err,decode){return decode})};exports.validateToken=validateToken;var publicKeyServer="-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0TlmjdegY60EXB2y5IR/\nVsAbIlIkWy6+buF3KJAm9Hv+MEasOhqPPpCEOk4e3cv9wm1H2USNm+STEgFelEn7\nlEe1oldrkTfrC/2SqoLxHPFKai86ni5BuIXJ8wuhXNA8crCIFvsGZTzZjUyjzq9T\nby/muPD3Er8RbPs7eagJPvqoYCiilREl2u2MHhs38n6g9UGDrPQPNcyZ2fS2+1dG\n2gVRILlNBtaLpf1ULPH4M6wSUrDXDaK2Jqn8rU4mw2SaMKY2MnBzStxe7PP8IEnM\nqk8RCV1+D8STephfMKadTBNqft58Tjye5lEGBu2sINd8ro52A4hAnaWQd1bDoYPK\nLQIDAQAB\n-----END PUBLIC KEY-----";var privateKeyServer="-----BEGIN RSA PRIVATE KEY-----\nMIIEpQIBAAKCAQEAxpQPpHiKrzzWdrbgQy/EYcC6kAnDgTyuc7mGWCM6765HLEpH\n5XCwD8IS11YTnTNqgUHoykphmgUOWGcHv39z5FysttLY5x+A+X+hgaM+Tk4I4qLh\nwp/pCzaGe9zz2DYukU3Ei/eIx+U0DpT4Gv6HlAhAmheqA9eGtIocLz0cMW9EY4pI\nzxsN4xrVm7Sd9u2/88UgZ54sef1gDXSpVYN01+L8/N1g4XB3PQ7My1CxB8fOUp5I\n/LpSJwlnfaOqf+unmnyNou4PfAG5lWzy5lFP2cV0KQtscxTE0vRv5PFPOQsH3Ii9\nLD6tFH+34Qrz85ncwD/U84RnvRKT8BEM4Xjy2QIDAQABAoIBAQCcETO2DLLahNL9\nHD9nLnyGY0V8/N91i+6DrzTBwnaIdw0i5wJYddc5m0rZiKIDs6wqCFXf3tOUjBK5\nMchqHc5ElP189ntYMm9YJ5IUY+sM+dGL5X3PS4SJtoG9iWrv661vr5Igexw6Fo5y\nQ2w3MwH1OwMi2CRbvqD09XKvQbUNt8QlNYTZZpsDg5Q2sRmjcVr6Y7Z99DMvBGwF\nd2KK5PcznG0fN0D7cg8tDBu3G+P3IVBmAkKXKF5DboTgASDVILcF7AnFsTtZ6XRP\nFKotyCXhZR3roYZY7Knkrt18udMAV72v4rMjK9PkprhxyLmByYSkLGAjdC1Vubvc\n1HuS/XmtAoGBAPfgxgkZxJ95mu/OSPfRTw2j2BPQBvXY3c2JM0cVTXrQmIm17FuI\nkIQwUmuiKQLRHEA0dLSUC/WnMIgorC83RdjQnu+/gqafoJnvj1FbmxzHn/2dZOi+\nYeedGM4l1Pvt9nyo1+vWhgq5EMkbpGVmTSO4bfZHT4Ih6TVaxuo5DibLAoGBAM0V\nwcS4oCmBMxRjAcrGTS2fxM5bY2DmXDLYiHUkIvrnxEayOzXF9ymAsbMjXJkM46ax\nn/tVrN5AnMa0+dz086kDCZ6TWYL/mB4mM4yvRp2BRmdq3+9uw1JDBS1G5RkOf/HS\nzgCqrAoWeUe5pnUNYvUSc3MMgfNwSxWZFIPO2LRrAoGBAIEQ3IyoiiSvYOk0c/H1\nXkAv67aFPtqLzRHUOorsoKcuLf6mZydR+E2cC45XpRr+XsNfjNTpsUB7iV2cL+t1\n0DyQg/E5uoGf5DPC9NDb7ewSVU/swDofx0KeHehY8okq4okOMT9vN+QlcIQGjJbv\nqYLL6RWvE8sidRd+6MvUYXX5AoGBALswQp52DeoUPTU8cSRN/5/HFnFrxLdrS3g1\nX8fb5fmxldsZTyXzvXcqOgfSHPCtbRR3SBi1yIVL4E0WXoGpKsV3Ok59G9SPyp6q\nK58bVI7qsgIu8JqwNKNe/Niovu8x5uIokVLWdRT4Ela/QwnP4CTkZG/8WJiERGRA\nRxNPt0hlAoGAdX11NW6fhNomRPJGtkFD4oY/vWdMgaokoYR8L+RgFXAH8eX4S9EA\nzPnX95EowZTsFdnMZLbiwHgLA77UsVBwhnc/8PGC0TTfT4usdLhyAYVY9RQ6SRSE\nc1jdNZYeM6v6ddFuUZ+qHP0VFu7CsJiOoKhYIInTD7IT4gM2vIlSPxw=\n-----END RSA PRIVATE KEY-----";var privateKeyUser="-----BEGIN RSA PRIVATE KEY-----\nMIIEowIBAAKCAQEA0TlmjdegY60EXB2y5IR/VsAbIlIkWy6+buF3KJAm9Hv+MEas\nOhqPPpCEOk4e3cv9wm1H2USNm+STEgFelEn7lEe1oldrkTfrC/2SqoLxHPFKai86\nni5BuIXJ8wuhXNA8crCIFvsGZTzZjUyjzq9Tby/muPD3Er8RbPs7eagJPvqoYCii\nlREl2u2MHhs38n6g9UGDrPQPNcyZ2fS2+1dG2gVRILlNBtaLpf1ULPH4M6wSUrDX\nDaK2Jqn8rU4mw2SaMKY2MnBzStxe7PP8IEnMqk8RCV1+D8STephfMKadTBNqft58\nTjye5lEGBu2sINd8ro52A4hAnaWQd1bDoYPKLQIDAQABAoIBAB0eUQCSrvbQYJf1\nZi1Zp2NKbzxSlE7Aba5+4JeboGBMVW8glt2rTp5VfKGkt7UEq/eAQAyj9tVodXN/\nD0uyFDpp1ISYiBb44lST4PKsMKRnjITEt/LF2020CQwzZSzGqnMH0JjqLNSwKFL7\nBJ1CV2lVEFZS6wAH6YPyXy+qTEcgWRXF45w87KMy4AgI1bTno+YITkg6x+uHrCuq\ntIwG3paiC1GB6WY30N95OoAkva6CvEVgb1LK0V4BluPIE5P8nkRZOyUOGTtE4YxX\noaB7ciyALzPBG0FxO7AxjLupLL7EppTC9Z99k+ewV8aCV82q/P1X84emWwjXyL5r\nGInAMWECgYEA7oLX+aOSqjzxFrsROOLj+ENb2fEcYYLGHJ2xJEzth2FxzsNMy6hI\nYooJXfJwG0B1V7cq9bGvreyg7InsIqkLSk6yWlI3W+yeUb51cxQ5MgNunJIB0VH7\nFN8vA7yYaSjIXUMLGqWKeQRUkSwqE03rMx7CnvFTlHVizUi0m+k7M9UCgYEA4JDO\nDY9w0VSh6FoscSII0+1r9Iutdh4kDWDlHwY5LLGszI8RbiPG2oNgnDwoDaOwIBEh\n4rpkI1guQT7G/ck6vWbAidPlDOOHpgddG7j79NU7yyrPerXbwzgafaIWjmc7hVI8\ndDLdVQcrCOmi49jSq/SkmxpZMlcqfvkyuuFE4PkCgYAKhXUXixKuNdAAy7G/y6p4\nyifkHlG9L3Kj0oT87/POdAr8LvtVRJAk4Kf3H/m4CgjjHK5ldjgkuPqEVLU49jIM\nThpqB5RvlqmJO5icwfif7yzS9VHlNPOZgRrm1Ev435avHoT/4OuR2RIN8V/NyDMm\n5yV4s3aXZvI70gg9lHVLHQKBgFKjVwBMedK+lzo+/L3BLYh3hVOflvyxiMjXkFlD\nXATjeVhpiZuDVOkSkZnM1Vx3kRer1lFuD+2lxJfD90xrIc+TIWVW8aI1lLR3Xz8V\narqlQXS5U1Kv26hSXAVBgZVzzcZ5BcAo+6QPmDmWaJf6MUSQKYbeQlaxFvVU1ONK\nhKNZAoGBALD079+Lv1owFpJ60Xsnmv5DBPhv8nc3JBmxQECBC3oU9NLAqOZqMJ2D\nU8JqhNup/3wJj6I0ekyP3aEfVh0QbegDH/duPHexRYi5qeyEq0FBOY2ja2TcoEFw\nl5mfi6vzQoLCd+tCTqQAVwVMGa202QTUeM1hAOg5tgLUfjWkWtsz\n-----END RSA PRIVATE KEY-----";var publicKeyuser="-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxpQPpHiKrzzWdrbgQy/E\nYcC6kAnDgTyuc7mGWCM6765HLEpH5XCwD8IS11YTnTNqgUHoykphmgUOWGcHv39z\n5FysttLY5x+A+X+hgaM+Tk4I4qLhwp/pCzaGe9zz2DYukU3Ei/eIx+U0DpT4Gv6H\nlAhAmheqA9eGtIocLz0cMW9EY4pIzxsN4xrVm7Sd9u2/88UgZ54sef1gDXSpVYN0\n1+L8/N1g4XB3PQ7My1CxB8fOUp5I/LpSJwlnfaOqf+unmnyNou4PfAG5lWzy5lFP\n2cV0KQtscxTE0vRv5PFPOQsH3Ii9LD6tFH+34Qrz85ncwD/U84RnvRKT8BEM4Xjy\n2QIDAQAB\n-----END PUBLIC KEY-----";